# Инструкция по очистке базы данных

## ⚠️ ВНИМАНИЕ
Очистка базы данных удалит **ВСЕ** данные:
- Всех пользователей
- Всех исполнителей
- Все назначения задач
- Все справочники Planfix
- Все статусы и шаблоны задач
- Все логи

**Операция необратима!**

## Способы очистки БД

### Способ 1: Использование Python скрипта (рекомендуется)

```bash
# Интерактивная очистка (с подтверждением)
python clear_database.py

# Принудительная очистка (без подтверждения, для автоматизации)
python clear_database.py --force
```

Скрипт:
- Удалит все таблицы из БД
- Пересоздаст структуру БД с пустыми таблицами
- Сохранит файл БД

### Способ 2: Удаление файла БД (простой способ)

#### На Linux/Mac:
```bash
# Остановите бота (Ctrl+C)
# Затем выполните:
rm bot.db

# Или используйте скрипт:
bash clear_database_simple.sh
```

#### На Windows:
```powershell
# Остановите бота (Ctrl+C)
# Затем выполните:
del bot.db

# Или в PowerShell:
Remove-Item bot.db
```

При следующем запуске бота БД будет создана автоматически.

### Способ 3: Через SQLite (если установлен)

```bash
# Подключитесь к БД
sqlite3 bot.db

# Удалите все данные из таблиц
DELETE FROM user_profiles;
DELETE FROM executor_profiles;
DELETE FROM task_assignments;
DELETE FROM planfix_directories;
DELETE FROM planfix_directory_entries;
DELETE FROM planfix_task_statuses;
DELETE FROM planfix_task_templates;
DELETE FROM bot_logs;

# Выйдите
.quit
```

## Важные замечания

1. **Остановите бота** перед очисткой БД, чтобы избежать ошибок
2. **Сделайте резервную копию** БД перед очисткой, если данные важны:
   ```bash
   cp bot.db bot.db.backup
   ```
3. После очистки БД:
   - Все пользователи должны зарегистрироваться заново
   - Все исполнители должны зарегистрироваться заново
   - Справочники Planfix будут синхронизированы при следующем запуске
   - Статусы задач будут загружены из Planfix при следующем запуске

## Восстановление из резервной копии

Если вы сделали резервную копию:

```bash
# Остановите бота
# Восстановите БД
cp bot.db.backup bot.db
# Запустите бота
```

## Расположение файла БД

По умолчанию файл БД находится в корне проекта: `bot.db`

Путь можно изменить в файле `.env`:
```
DB_PATH=bot.db
```

